name: Publish npm package

on:
  workflow_call:
    inputs:
      artifactName:
        description: Name of the uploaded build artifact
        required: false
        type: string
      artifactPath:
        description: Destination path for the downloaded build artifact
        required: false
        type: string
    secrets:
      NPM_TOKEN:
        required: true
      CB_CI_WORKFLOW_TOKEN:
        required: true

jobs:
  release:
    name: Publish to NPM ðŸš€
    runs-on: ubuntu-latest
    steps:
      - name: Semantic Release
        uses: cloudbeds/workflows/.github/actions/semantic-release@main
        with:
          artifactName: ${{ inputs.artifactName }}
          artifactPath: ${{ inputs.artifactPath }}
          withoutBuiltArtifact: ${{ !inputs.artifactName && 'true' }}
          publishToNpm: true
          GITHUB_TOKEN: ${{ secrets.CB_CI_WORKFLOW_TOKEN }}
          NPM_TOKEN: ${{ secrets.NPM_TOKEN }}
